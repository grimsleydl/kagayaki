# Maintainer: julroy67 <julroy67@gmail.com>
# Contributor: Lukas Fleischer <lfleischer@archlinux.org>
# Contributor: Ronald van Haren <ronald.archlinux.org>
# Contributor: Roman Kyrylych <Roman.Kyrylych@gmail.com>
# Contributor: Andreas Zwinkau
# Contributor: rabyte <rabyte__gmail>
# Contributor: Stefan Husmann <stefan-husmann@t-online.de>
# Contributor: bohoomil <@zoho.com>

pkgname=liberation-kagayaki
pkgver=2.00.3
_narrowver=1.07.2
_commit=7c0f88d
_narrowcommit=86fda57
pkgrel=2
pkgdesc='Red Hats Liberation fonts'
arch=('any')
url="https://github.com/pravins/liberation-fonts"
license=('custom:OFL')
depends=('fontconfig' 'xorg-fonts-encodings' 'xorg-mkfontscale' 'xorg-mkfontdir')
makedepends=('python-fonttools' 'fontforge')
provides=('ttf-font' 'ttf-liberation')
conflicts=('ttf-liberation-kagayaki' 'ttf-liberation')
groups=('kagayaki-bundle-fonts')
source=("https://github.com/pravins/liberation-fonts/archive/$_commit.zip"
		"https://github.com/pravins/liberation-fonts/archive/$_narrowcommit.zip"
        42-liberation.conf)
md5sums=('59699853aea3ba875620d72747e4573a'
         '4096f88ad5b7037202b17dd4ce12c221'
         '14f570a5caa6e379b8753534a92c54f1')

package() {
	cd "${srcdir}/liberation-fonts-7c0f88de84f61ae1d9fe692401d47458fa325dba"

	make

	# Install license
	install -Dm644 "LICENSE" \
		"${pkgdir}"/usr/share/licenses/"${pkgname}"/COPYING

	cd "liberation-fonts-ttf-${pkgver}"

	# Install font
	install -m755 -d "${pkgdir}"/usr/share/fonts/kagayaki/"${pkgname}"
	install -m644 *.ttf \
		"${pkgdir}"/usr/share/fonts/kagayaki/"${pkgname}"

	cd "${srcdir}/liberation-fonts-86fda57f244623f4df5cc193ff1b8fbce4ee56a6/source"

	make

	cd "liberation-fonts-ttf-${_narrowver}"

	# Install font
	install -m644 *Narrow-*.ttf \
		"${pkgdir}"/usr/share/fonts/kagayaki/"${pkgname}"

	# Install infinality conf
	cd "${srcdir}"
	install -m755 -d "${pkgdir}"/etc/fonts/conf.avail
	install -m755 -d "${pkgdir}"/etc/fonts/conf.d
	install -m644 42-liberation.conf \
		"${pkgdir}"/etc/fonts/conf.avail/42-liberation.conf
	
	cd "${pkgdir}"/etc/fonts/conf.d
	ln -s ../conf.avail/42-liberation.conf .
}
